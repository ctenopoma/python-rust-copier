# {{ project_name }}

Rust-backed Python library scaffold generated by Copier with a PyO3 native module.

## Prerequisites
- Python >= {{ python_version }}
- Rust toolchain ({{ rust_toolchain }}) with `cargo fmt` and `clippy`
- uv, maturin, and copier installed in your development environment
{%- if use_docker %}
- **Docker & Docker Compose** (optional, for containerized development)
{%- endif %}

{% if use_docker %}
## Docker Development (Recommended)

### Quick Start with Docker
```bash
# Build and start the development container
docker-compose up -d

# Enter the container
docker-compose exec dev bash

# Inside the container, run bootstrap commands
uv sync --group dev
uv run maturin develop
uv run pytest
```

### Docker Container Management
```bash
# Start container
docker-compose up -d

# View logs
docker-compose logs -f

# Stop container
docker-compose down

# Rebuild container (after Dockerfile changes)
docker-compose up -d --build
```

The Docker setup includes:
- Python {{ python_version }} with development headers
- Rust {{ rust_toolchain }} toolchain with rustfmt and clippy
- uv package manager pre-installed
- Persistent volumes for Cargo cache and build artifacts
- Port 8000 exposed for documentation server

{% endif %}
## Bootstrap
1. `uv sync --group dev`
2. `uv run maturin develop`
3. `uv run ruff check`
4. `uv run pyrefly`
5. `uv run pytest`
6. `cargo fmt -- --check`
7. `cargo clippy -- -D warnings`
8. `cargo test`

## Build artifacts
- `uv build` to produce wheel and sdist artifacts via the maturin backend
- See `BUILDING.md` for troubleshooting steps and verification commands

## Docs
- `uv run maturin develop` (once) to ensure the extension module is available
- `uv run sphinx-build -b html docs build/docs`

## Build automation
{%- if target_platform in ['Windows', 'Both'] %}
- Windows: `.\build.ps1` (add `-Docs` to build documentation)
{%- endif %}
{%- if target_platform in ['Linux', 'Both'] %}
- Linux/macOS: `./build.sh --docs` to include documentation
{%- endif %}

## Nox shortcuts
- `nox -s lint`
- `nox -s test`
- `nox -s build`
- `nox -s docs`

## Project layout
- `pyproject.toml`: Python metadata, dependency groups, and tooling configuration
- `Cargo.toml`: Rust crate metadata for the PyO3 extension module `{{ package_name | replace('-', '_') }}_native`
- `src/lib.rs`: Native module implementation with basic functions and error mapping
- `{{ package_name }}/__init__.py`: Python-facing API that re-exports the native functions
- `ruff.toml`: Ruff lint/format configuration
- `README.md`: This guide
- `BUILDING.md`: Build pipeline notes and verification commands
- `docs/`: Sphinx configuration (`conf.py`) and documentation index (`index.rst`)
- `tests/`: Rust unit tests and Python integration tests exercising the PyO3 boundary

## Windows toolchain tips
- Install MSVC Build Tools and ensure `cl.exe` is on `PATH` (run `where cl` to verify)
- Avoid spaces or non-ASCII characters in the project path to prevent linker issues
- Set `UV_LINK_MODE=copy` if symlink creation fails on locked-down environments
- Keep `rustup default {{ rust_toolchain }}` and install `rustfmt` + `clippy` components for CI parity

## Update the template
Run `copier update --trust` to pull the latest template changes. The post-generation hook logs answers to `copier_log.txt`, writes `template-metadata.json`, and appends entries to `CHANGELOG.md` for auditability.
